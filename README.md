**Функционал данного проекта:**

**1** Управление поставщиками и товарами через API интерфейсы.

**2** Автоматическая отправка email-подтверждения клиентам после регистрации и оформления заказа.

**3** Система управления заказами с возможностью оформления и подтверждения заказов.

**4** Поддержка импорта товаров из YAML-файлов.

**5** Детальное ведение карточек товаров с указанием цен, количества на складе и атрибутов.

**6** Администрирование и управление всеми объектами через встроенную административную панель Django.

## Инструкция по разворачиванию проекта

### Предварительные условия:

- **Установленный Python 3.10 и выше**
- **Любая удобная для работы БД**

### Установка и запуск:

Склонируйте репозиторий:

`git clone https://github.com/Kamendrovsky7/backend-diplom

Активируйте виртуальное окружение:

**Windows**

`python -m venv venv`----->
`.venv\Scripts\activate.bat`

**Linux/Mac**

`python -m venv .venv`----->
`source .venv/bin/activate`

Установите зависимости:

`pip install -r requirements.txt`

Склонируйте переменные окружения

Создайте базу данных (sqlite3 создается автоматически)

`psql -U postgres -c "CREATE DATABASE your_db"`

Запустите миграции:

`python manage.py migrate`

Загрузите тестовые данные (при наличии):

`python manage.py loaddata data.yaml`

Запустите сервер разработки:

`python manage.py runserver`

Доступ по адресу: **http://localhost:8000/**.

**Основные API включают:**

- Регистрацию и авторизацию пользователей.
- Логику корзины покупок и оформление заказов.
- Каталог товаров и подробную информацию о продуктах.
- Функционал отправки email-клиентам.

- **Тестирование:**

Тесты реализованы с использованием стандартных инструментов тестирования Django. Их можно запустить следующей командой:

`python manage.py test`

## **История разработки:**

- Внедрение базовых моделей данных и начальной инфраструктуры.
- Реализация функционала импорта товаров из YAML-файлов.
- Организация работы с пользователями, регистрацией и аутентификацией.
- Расширение API для взаимодействия с корзинами и заказами.
- Завершающая интеграция системы отправки email.

## Документация API сервиса магазина:

Доступные эндпоинты API для сервиса магазина, включая базовые функции аутентификации, управления корзиной, оформления
заказов и просмотра информации о товарах.

---

### 1. Регистрация и авторизация

Метод POST:

`/api/register/` `username`, `email`, `password`, `first_name`, `last_name` ----- Регистрация нового пользователя.

`/api/login/` `username`, `password` ----- Вход пользователя.

---

### 2. Получение списков и деталей по ID

Метод GET:

`/api/suppliers/`----- Получение списка всех поставщиков.

`/api/products/`----- Получение списка всех товаров.

`/api/categories/`----- Получение списка всех категорий.

`/api/suppliers/{id}/`----- Получение деталей конкретного поставщика `id` поставщика.

`/api/products/{id}/`----- Получение деталей конкретного товара `id` товара.

`/api/categories/{id}/`----- Получение деталей конкретной категории `id` категории.

### 3. Работа с корзиной

МЕТОД GET `/api/cart/` ------ Просмотр содержимого корзины текущего пользователя.

МЕТОД POST `/api/cart/items/` ----- Добавление товара в корзину и его количества `{ "product_id": int, "quantity": int }`. Требуется аутентификация. `product_id` - ID существующего товара.

МЕТОД PUT `/api/cart/items/{id}/` ----- Обновление количества товара в корзине`{ "quantity": int }` . Требуется аутентификация. `id` - ID элемента корзины.

МЕТОД PATCH `/api/cart/items/{id}/` ----- Частичное обновление количества товара `{ "quantity": int }`. Требуется аутентификация. `id` - ID элемента корзины.

МЕТОД DELETE `/api/cart/items/{id}/` ----- Удаление товара из корзины. Требуется аутентификация. `id` - ID элемента корзины.

---

### 4. Работа с заказом

МЕТОД GET `/api/orders/` ----- Получение списка всех заказов текущего пользователя.

МЕТОД GET `/api/orders/{id}/` ------ Получение деталей конкретного заказаю. Требуется аутентификация. `id` - ID заказа. Пользователь может просматривать только свои заказы.

МЕТОД POST `/api/orders/` ----- Создание нового заказа из корзины `{ "cart_id": int, "shipping_address": str, "phone_number": str }`. Требуется аутентификация. `cart_id` - ID корзины, из которой создается заказ. `shipping_address` и `phone_number` (или берутся из профиля `Customer`). Корзина должна быть не пустой.

МЕТОД PATCH `/api/orders/{id}/confirm_order/` ------ Изменение статуса заказа (доступ для админа) `{ "status": "confirmed"| "cancelled" | "shipped" | ... }` (выберите допустимый статус). Требуется аутентификаци **администратора**. `id` - ID заказа.

### 5. Особые проверки

- **Автоматическое создание корзины:** Корзина создается автоматически при первом добавлении товара, если ее нет.
- **Очистка корзины после заказа:** Корзина и ее элементы автоматически удаляются после успешного создания заказа.
- **Отправка email подтверждения заказа:** Отправляется при успешном создании заказа (`POST /api/orders/`) и при ручном
  изменении статуса на "confirmed" администратором.
- **Обработка ошибок:** Корректная обработка ошибок аутентификации, авторизации, невалидных данных, отсутствующих
  объектов.
- **Права доступа:** Анонимные пользователи не имеют доступа к корзине и заказам. Обычные пользователи видят только свои
  заказы. Администраторы могут подтверждать заказы.
